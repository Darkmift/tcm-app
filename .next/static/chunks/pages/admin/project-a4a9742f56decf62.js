(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[242],{6242:function(e,n,t){"use strict";t.d(n,{Z:function(){return y}});var r=t(7462),i=t(3366),o=t(7294),s=t(6010),a=t(4780),u=t(948),c=t(1657),l=t(629),d=t(1588),m=t(4867);function p(e){return(0,m.Z)("MuiCard",e)}(0,d.Z)("MuiCard",["root"]);var f=t(5893);let h=["className","raised"],v=e=>{let{classes:n}=e;return(0,a.Z)({root:["root"]},p,n)},j=(0,u.ZP)(l.Z,{name:"MuiCard",slot:"Root",overridesResolver:(e,n)=>n.root})(()=>({overflow:"hidden"})),g=o.forwardRef(function(e,n){let t=(0,c.Z)({props:e,name:"MuiCard"}),{className:o,raised:a=!1}=t,u=(0,i.Z)(t,h),l=(0,r.Z)({},t,{raised:a}),d=v(l);return(0,f.jsx)(j,(0,r.Z)({className:(0,s.Z)(d.root,o),elevation:a?8:void 0,ref:n,ownerState:l},u))});var y=g},5279:function(e,n,t){"use strict";t.d(n,{Z:function(){return u}});var r=t(7294),i=t(1163),o=t(7029),s=t(5893),a=function(e){var n=e.requiredRole,t=e.children,a=(0,i.useRouter)(),u=(0,o.CG)(function(e){return e.auth.isLoggedIn}),c=(0,o.CG)(function(e){return e.auth.role}),l=(0,o.CG)(function(e){return e.auth.authDone});return(0,r.useEffect)(function(){l&&!u&&a.push(n!==c?"/":"/admin/login")},[l,u,c,n,a]),(0,s.jsx)(s.Fragment,{children:u&&c===n?t:(0,s.jsx)(s.Fragment,{})})},u=function(e,n){var t=function(){return(0,s.jsx)(a,{requiredRole:n,children:(0,s.jsx)(e,{})})};return t.displayName="withProtectedRoute(".concat(e.displayName||e.name||"Component",")"),t}},7804:function(e,n,t){"use strict";t.r(n),t.d(n,{default:function(){return k}});var r=t(3156),i=t(7294),o=t(6242),s=t(5861),a=t(5279),u=t(7029),c=t(2266),l=t(29),d=t(9499),m=t(7191),p=t(7794),f=t.n(p),h=t(2580),v=t(6886),j=t(6310),g=t(9807),y=t(4457),x=t(8195),Z=t(8025),b=t(113),w=t(8987),C=t(190),I=t(4148),O=t(5893);function P(e,n){var t=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);n&&(r=r.filter(function(n){return Object.getOwnPropertyDescriptor(e,n).enumerable})),t.push.apply(t,r)}return t}function K(e){for(var n=1;n<arguments.length;n++){var t=null!=arguments[n]?arguments[n]:{};n%2?P(Object(t),!0).forEach(function(n){(0,d.Z)(e,n,t[n])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(t)):P(Object(t)).forEach(function(n){Object.defineProperty(e,n,Object.getOwnPropertyDescriptor(t,n))})}return e}var _=j.Ry({name:j.Z_().required("Name is required"),description:j.Z_().required("Description is required"),image:j.nK(),year:j.nK().test("is-year","Select a year",function(e){return!e||"year"in e&&"is_enabled"in e}),members:j.IX(),internshipId:j.nK().test("is-internship","Select an internship",function(e){return!1===(0,y.Z)(e)||!e||"id"in e&&"name"in e}),instructorId:j.nK().test("is-instructor","Select an instructor",function(e){return!1===(0,y.Z)(e)||!e||"id"in e&&"name"in e})}),S={description:"",image:void 0,name:"",year:[],members:[],instructorId:[],internshipId:[]},L=["name","description"],E=function(e){return{}},F=function(e){(0,m.Z)(e);var n,t=(0,u.TL)(),r=(0,u.CG)(function(e){return e.years.years}),o=(0,u.CG)(function(e){return e.members.members}),a=(0,u.CG)(function(e){return e.internships.internships}),c=(0,u.CG)(function(e){return e.instructors.allInstructors}),d=(0,i.useState)(""),p=d[0],j=d[1],y=(0,i.useState)({severity:"info",open:!1,msg:""}),P=y[0],F=y[1],N=(0,i.useState)(!1),R=N[0],k=N[1],G=[{name:"year",multiple:!1,values:r,optionLabelKey:"year",optionIdKey:"id"},{name:"members",multiple:!0,values:o,optionLabelKey:"name",optionIdKey:"id"},{name:"instructorId",multiple:!1,values:c,optionLabelKey:"name",optionIdKey:"id"},{name:"internshipId",multiple:!1,values:a,optionLabelKey:"name",optionIdKey:"id"}];(0,i.useEffect)(function(){var e;return P.open&&(e=setTimeout(function(){F(K(K({},P),{},{open:!1}))},4e3)),function(){return clearTimeout(e)}},[P]);var D=(0,i.useRef)(),T=(n=(0,l.Z)(f().mark(function e(n,r){var i,o;return f().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,j(""),k(!0),!(i=structuredClone(n)).image){e.next=11;break}return e.next=7,(0,x.Z)({title:i.name,collectionName:"projects",imageFile:i.image});case 7:if(null!==(o=e.sent)){e.next=10;break}throw Error("Failed to save image");case 10:i.image=o.url;case 11:t((0,g.$L)(i)).unwrap().then(function(e){console.log("\uD83D\uDE80 ~ file: ProjectForm.tsx:144 ~ .then ~ data:",e),F({severity:"success",open:!0,msg:"created with id: "+e.id}),r.setSubmitting(!1),r.resetForm({values:S}),D.current&&(D.current.value="")}).catch(function(e){j(e.message),F({severity:"error",open:!1,msg:e.message})}).finally(function(){k(!1)}),e.next=18;break;case 14:e.prev=14,e.t0=e.catch(0),console.log("\uD83D\uDE80 ~ file: ProjectForm.tsx:167 ~ handleSubmit ~ error:",e.t0),j(e.t0.message);case 18:return e.prev=18,k(!1),e.finish(18);case 21:case"end":return e.stop()}},e,null,[[0,14,18,21]])})),function(e,t){return n.apply(this,arguments)});return(0,O.jsx)(h.J9,{initialValues:S,validationSchema:_,onSubmit:T,validate:E,enableReinitialize:!0,children:function(e){var n=e.errors,t=e.touched,r=e.setFieldValue;return(0,O.jsxs)(h.l0,{children:[L.map(function(e){return(0,O.jsx)(Z.Z,{isMultiLine:"description"===e,rowNums:4,item:e,touched:t,errors:n},e)}),(0,O.jsx)(v.ZP,{container:!0,spacing:1,alignItems:"stretch",children:G.map(function(e,r){var i=e.name,o=e.multiple,s=e.values,a=e.optionLabelKey,u=e.optionIdKey;return(0,O.jsx)(v.ZP,{item:!0,xs:6,alignItems:"center",children:(0,O.jsx)(b.Z,{optionLabelKey:a,optionIdKey:u,isMultiLine:o,options:s,item:i,touched:t,errors:n})},r)})}),(0,O.jsx)(I.Z,{onChange:function(e){r("image",e.currentTarget.files[0])},item:"image",touched:t,errors:n}),(0,O.jsx)(w.Z,{fullWidth:!0,variant:"contained",loading:R,loadingIndicator:"Loadingâ€¦",type:"submit",children:"Create Project"}),p&&(0,O.jsx)(s.Z,{sx:{p:2,color:"red"},variant:"h6",textAlign:"center",children:p}),null!=P&&P.open&&null!=P&&P.msg?(0,O.jsx)(C.Z,{open:P.open,message:P.msg,severity:P.severity}):(0,O.jsx)(O.Fragment,{})]})}})},N=t(2372),R=t(2593),k=(0,a.Z)(function(){var e=(0,u.CG)(function(e){return e.years.selectedYear}),n=(0,u.CG)(function(e){return e.projects.projects}),t=(0,i.useState)(null),a=t[0],l=t[1];return(0,i.useEffect)(function(){!a&&null!=n&&n[0]&&l(n[0])},[n]),(0,O.jsxs)(r.Z,{sx:{display:"flex",flexDirection:"column",gap:"20px"},children:[(0,O.jsx)(R.Z,{}),(0,O.jsxs)(o.Z,{raised:!0,sx:{p:4},children:[(0,O.jsx)(s.Z,{variant:"h4",children:"Add Project Form"}),(0,O.jsx)(F,{})]}),!(null!=n&&n.length)&&(0,O.jsx)(o.Z,{raised:!0,sx:{p:4},children:(0,O.jsxs)(s.Z,{variant:"h6",children:["There are no projects for ",e]})}),null!=n&&n.length&&a?(0,O.jsxs)(o.Z,{raised:!0,sx:{p:4},children:[(0,O.jsx)(s.Z,{variant:"h4",children:"Edit Project Form"}),(0,O.jsx)(c.Z,{value:a,handleChange:function(e){return l(e.target.value)},multiple:!1,name:"",options:n,optionLabelKey:"name",optionIdKey:"id"}),(0,O.jsx)(N.Z,{project:a})]}):(0,O.jsx)(O.Fragment,{})]})},"Admin")},1285:function(e,n,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/admin/project",function(){return t(7804)}])}},function(e){e.O(0,[135,929,471,886,860,328,774,888,179],function(){return e(e.s=1285)}),_N_E=e.O()}]);