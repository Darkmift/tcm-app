"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[328],{2593:function(e,t,n){var r=n(7191),i=n(3321),o=n(5861);n(7294);var a=n(1163),s=n(1023),l=n(5893);t.Z=function(e){(0,r.Z)(e);var t=(0,a.useRouter)();return(0,l.jsxs)(i.Z,{onClick:function(){return t.back()},sx:{display:"flex",maxWidth:"175px",alignItems:"center"},variant:"outlined",children:[(0,l.jsx)(s.Z,{}),(0,l.jsx)(o.Z,{sx:{mt:"3px",mx:2},children:"Go Back"})]})}},4148:function(e,t,n){var r=n(4054),i=n(6886),o=n(135),a=n(2580),s=n(7294),l=n(5675),u=n.n(l),c=n(8677),p=n(5893);t.Z=function(e){var t=e.onChange,n=e.item,l=e.touched,d=e.errors,m=e.originalFileSrc,f=c.LT+"/projects/default-project-img.jpg",h=(0,s.useState)(m),g=h[0],x=h[1];(0,s.useEffect)(function(){x(m)},[m]);var v=function(e){var r=e.target.files;if(r&&r.length>0){var i=r[0];x(URL.createObjectURL(i)),t({currentTarget:{name:n,files:[i],value:i}})}};return(0,p.jsx)(a.gN,{name:n,children:function(e){var t=e.field;return(0,p.jsx)(r.Z,{fullWidth:!0,margin:"normal",error:l[n]&&!!d[n],children:(0,p.jsxs)(i.ZP,{container:!0,spacing:2,children:[(0,p.jsx)(i.ZP,{item:!0,xs:2,children:(0,p.jsx)(u(),{width:175,height:175,src:g||f,alt:n})}),(0,p.jsx)(i.ZP,{item:!0,xs:10,children:(0,p.jsx)(o.Z,{sx:{py:1},fullWidth:!0,variant:"standard",id:n,name:t.name,onChange:v,label:t.name.toUpperCase(),type:"file",InputLabelProps:{shrink:"image"===n},error:l[n]&&!!d[n],helperText:l[n]&&d[n]})})]})})}})}},8025:function(e,t,n){var r=n(9499),i=n(4054),o=n(135),a=n(2580);n(7294);var s=n(5893);function l(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}t.Z=function(e){var t=e.disabled,n=e.isMultiLine,u=e.rowNums,c=e.item,p=e.touched,d=e.errors;return(0,s.jsx)(a.gN,{name:c,children:function(e){var a=e.field;return(0,s.jsx)(i.Z,{fullWidth:!0,margin:"normal",error:p[c]&&!!d[c],children:(0,s.jsx)(o.Z,function(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?l(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):l(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}({disabled:t,sx:{py:1},fullWidth:!0,variant:"description"===a.name?"outlined":"standard",id:c,name:a.name,value:a.value,onChange:a.onChange,label:a.name.toUpperCase(),type:"text",error:p[c]&&!!d[c],helperText:p[c]&&d[c]},n?{multiline:!0,rows:u}:{}),c)})}},c)}},113:function(e,t,n){var r=n(4054),i=n(2580);n(7294);var o=n(2266),a=n(5893);t.Z=function(e){var t=e.optionLabelKey,n=e.optionIdKey,s=e.isMultiLine,l=e.options,u=e.item,c=e.touched,p=e.errors;return(0,a.jsx)(i.gN,{name:u,children:function(e){var i=e.field;return(0,a.jsx)(r.Z,{fullWidth:!0,margin:"normal",error:c[u]&&!!p[u],children:(0,a.jsx)(o.Z,{multiple:!!s,value:i.value,handleChange:i.onChange,name:i.name,options:l,optionLabelKey:t,optionIdKey:n,error:c[u]&&!!p[u],helperText:c[u]&&p[u]})})}},u)}},2372:function(e,t,n){var r=n(9499),i=n(29),o=n(7794),a=n.n(o),s=n(7294),l=n(2580),u=n(6886),c=n(5861),p=n(6310),d=n(7029),m=n(9807),f=n(4457),h=n(8195),g=n(8025),x=n(113),v=n(8987),j=n(190),y=n(8270),b=n(4148),Z=n(5893);function P(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(e);t&&(r=r.filter(function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable})),n.push.apply(n,r)}return n}function O(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{};t%2?P(Object(n),!0).forEach(function(t){(0,r.Z)(e,t,n[t])}):Object.getOwnPropertyDescriptors?Object.defineProperties(e,Object.getOwnPropertyDescriptors(n)):P(Object(n)).forEach(function(t){Object.defineProperty(e,t,Object.getOwnPropertyDescriptor(n,t))})}return e}var w=p.Ry({name:p.Z_().required("Name is required"),description:p.Z_().required("Name is required"),image:p.nK(),year:p.Rx().min(2e3,"year is too early").max(2100,"year is too late"),members:p.IX(),internshipId:p.nK().test("is-internship","Select an internship",function(e){return!1===(0,f.Z)(e)||!e||"id"in e&&"name"in e}),instructorId:p.nK().test("is-instructor","Select an instructor",function(e){return!1===(0,f.Z)(e)||!e||"id"in e&&"name"in e})}),I=["name","description","year"],F=function(e){return{}};t.Z=function(e){var t,n,r,o=e.project,p=e.studentUsername,f={description:o.description,image:void 0,name:o.name,year:o.year,members:o.members,instructorId:o.expand&&null!==(n=o.expand)&&void 0!==n&&n.instructorId?[o.expand.instructorId]:[],internshipId:o.expand&&null!==(r=o.expand)&&void 0!==r&&r.internshipId?[o.expand.internshipId]:[]};(0,s.useEffect)(function(){function e(){return(e=(0,i.Z)(a().mark(function e(){var t,n,r,i,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.prev=0,r=(n=(t=o.image).substring(t.lastIndexOf("/")+1)).split(".")[1],i="image/".concat(r),e.next=7,(0,y.Z)(t,n,i);case 7:null!=(s=e.sent)&&s.size&&(f.image=s),e.next=14;break;case 11:e.prev=11,e.t0=e.catch(0),console.log("\uD83D\uDE80 ~ file: ProjectUpdateForm.tsx:101 ~ setImageFromUrl ~ error:",e.t0);case 14:case"end":return e.stop()}},e,null,[[0,11]])}))).apply(this,arguments)}console.log("\uD83D\uDE80 ~ file: ProjectUpdateForm.tsx:115 ~ ProjectUpdateForm ~ project.image:",o.image),function(){e.apply(this,arguments)}()},[o.image]);var P=(0,d.TL)(),C=(0,d.CG)(function(e){return e.members.members}),S=(0,d.CG)(function(e){return e.internships.internships}),k=(0,d.CG)(function(e){return e.instructors.allInstructors}),U=(0,s.useState)(""),K=U[0],L=U[1],N=(0,s.useState)({severity:"info",open:!1,msg:""}),W=N[0],D=N[1],E=(0,s.useState)(!1),T=E[0],R=E[1],M=[{name:"members",multiple:!0,values:C,optionLabelKey:"name",optionIdKey:"id"},{name:"instructorId",multiple:!1,values:k,optionLabelKey:"name",optionIdKey:"id"},{name:"internshipId",multiple:!1,values:S,optionLabelKey:"name",optionIdKey:"id"}];(0,s.useEffect)(function(){var e;return W.open&&(e=setTimeout(function(){D(O(O({},W),{},{open:!1}))},4e3)),function(){return clearTimeout(e)}},[W]);var _=(0,s.useRef)(),q=(t=(0,i.Z)(a().mark(function e(t,n){var r,i,s;return a().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,L(""),R(!0),!(null!==(r=(i=O(O({},o),structuredClone(t))).image)&&void 0!==r&&r.size)){e.next=12;break}return console.log("\uD83D\uDE80 ~ file: ProjectUpdateForm.tsx:186 ~ handleSubmit ~ projectFormData.image:",i.image),e.next=8,(0,h.Z)({title:i.name,collectionName:"projects",imageFile:i.image,studentUsername:p,studentProject:o});case 8:if(null!==(s=e.sent)){e.next=11;break}throw Error("Failed to save image");case 11:i.image=s.url;case 12:if(!(null!=p&&p.length)){e.next=15;break}return P((0,m.Xm)(i)).unwrap().then(function(e){console.log("\uD83D\uDE80 ~ file: ProjectForm.tsx:144 ~ .then ~ data:",e),D({severity:"success",open:!0,msg:"update complete"}),n.setSubmitting(!1),n.resetForm({values:f}),_.current&&(_.current.value="")}).catch(function(e){L(e.message),D({severity:"error",open:!1,msg:e.message})}).finally(function(){R(!1)}),e.abrupt("return");case 15:P((0,m.ty)(i)).unwrap().then(function(e){console.log("\uD83D\uDE80 ~ file: ProjectForm.tsx:144 ~ .then ~ data:",e),D({severity:"success",open:!0,msg:"update complete"}),n.setSubmitting(!1),n.resetForm({values:f}),_.current&&(_.current.value="")}).catch(function(e){L(e.message),D({severity:"error",open:!1,msg:e.message})}).finally(function(){R(!1)}),e.next=22;break;case 18:e.prev=18,e.t0=e.catch(0),console.log("\uD83D\uDE80 ~ file: ProjectForm.tsx:167 ~ handleSubmit ~ error:",e.t0),L(e.t0.message);case 22:return e.prev=22,R(!1),e.finish(22);case 25:case"end":return e.stop()}},e,null,[[0,18,22,25]])})),function(e,n){return t.apply(this,arguments)});return(0,Z.jsx)(l.J9,{initialValues:f,validationSchema:w,onSubmit:q,validate:F,enableReinitialize:!0,children:function(e){var t=e.errors,n=e.touched,r=e.setFieldValue;return console.log("\uD83D\uDE80 ~ file: ProjectUpdateForm.tsx:242 ~ ProjectUpdateForm ~ props:",e),(0,Z.jsxs)(l.l0,{children:[I.map(function(e){return(0,Z.jsx)(g.Z,{isMultiLine:"description"===e,rowNums:4,item:e,touched:n,errors:t,disabled:"year"===e},e)}),(0,Z.jsx)(u.ZP,{container:!0,spacing:1,alignItems:"stretch",children:M.map(function(e,r){var i=e.name,o=e.multiple,a=e.values,s=e.optionLabelKey,l=e.optionIdKey;return(0,Z.jsx)(u.ZP,{item:!0,xs:6,alignItems:"center",children:(0,Z.jsx)(x.Z,{optionLabelKey:s,optionIdKey:l,isMultiLine:o,options:a,item:i,touched:n,errors:t})},r)})}),(0,Z.jsx)(b.Z,{onChange:function(e){var t=e.currentTarget.files[0];console.log("\uD83D\uDE80 ~ file: ProjectUpdateForm.tsx:292 ~ ProjectUpdateForm ~ file:",t),r("image",t)},item:"image",touched:n,errors:t,originalFileSrc:o.image}),(0,Z.jsx)(v.Z,{fullWidth:!0,variant:"contained",loading:T,loadingIndicator:"Loadingâ€¦",type:"submit",children:"Update Project"}),K&&(0,Z.jsx)(c.Z,{sx:{p:2,color:"red"},variant:"h6",textAlign:"center",children:K}),null!=W&&W.open&&null!=W&&W.msg?(0,Z.jsx)(j.Z,{open:W.open,message:W.msg,severity:W.severity}):(0,Z.jsx)(Z.Fragment,{})]})}})}},190:function(e,t,n){n(7294);var r=n(8703),i=n(1737),o=n(5893);t.Z=function(e){var t=e.severity,n=e.open,a=e.message,s=e.handleClose;return(0,o.jsx)(r.Z,{open:n,autoHideDuration:4e3,onClose:s,children:(0,o.jsx)(i.Z,{onClose:s,severity:t,sx:{width:"100%",fontSize:"25px",fontWeight:"900"},children:a})})}},2266:function(e,t,n){n(7294);var r=n(2734),i=n(7058),o=n(3841),a=n(3599),s=n(4054),l=n(315),u=n(7918),c=n(3946),p=n(6815),d=n(3343),m=n(5893),f={PaperProps:{style:{maxHeight:224,width:250}}};t.Z=function(e){var t=e.value,n=e.handleChange,h=e.multiple,g=e.name,x=e.options,v=e.optionLabelKey,j=e.optionIdKey,y=e.error,b=e.helperText,Z=(0,r.Z)(),P=function(e){e.target.value||(e.target.value=h?[]:null),e.target.name=g,n(e)};return!!x&&(0,m.jsxs)(s.Z,{sx:{width:"100%"},error:y,children:[(0,m.jsx)(o.Z,{id:"demo-multiple-chip-label",children:g}),(0,m.jsx)(l.Z,{name:g,sx:{minHeight:"70px"},labelId:"demo-multiple-chip-label",id:"demo-multiple-chip",multiple:h,variant:"standard",value:t,onChange:P,input:(0,m.jsx)(i.Z,{id:"select-multiple-chip",label:"Chip"}),renderValue:function(e){if(h)return e.map(function(e,t){var n=x.find(function(t){return t[j]===e[j]});return(0,m.jsx)(u.Z,{label:n[v]},t)});if(null!=e&&null!==(t=e[0])&&void 0!==t&&t[j])return(0,m.jsx)(u.Z,{label:e[0][v],variant:"outlined"});var t,n=x.find(function(t){return t[j]===e[j]});return(0,m.jsx)(u.Z,{label:null==n?void 0:n[v],variant:"outlined"})},endAdornment:(0,m.jsx)(c.Z,{sx:{display:t?"":"none"},onClick:P,children:(0,m.jsx)(d.Z,{})}),MenuProps:f,children:x.map(function(e,t){return(0,m.jsx)(a.Z,{value:e,style:{fontWeight:-1===x.indexOf(g)?Z.typography.fontWeightRegular:Z.typography.fontWeightMedium},children:e[v]},t)})}),(0,m.jsx)(p.Z,{sx:{color:"red"},children:b})]})}},8195:function(e,t,n){n.d(t,{Z:function(){return l}});var r=n(29),i=n(7794),o=n.n(i),a=n(2610),s=n(3143);function l(e){return u.apply(this,arguments)}function u(){return(u=(0,r.Z)(o().mark(function e(t){var n,r,i,l,u,c;return o().wrap(function(e){for(;;)switch(e.prev=e.next){case 0:if(n=t.title,r=t.collectionName,i=t.imageFile,l=t.studentUsername,u=t.studentProject,c=t.originalFilename,e.prev=1,!l){e.next=7;break}return c&&(i.imageUrlUpdate=c),e.next=6,s.Z.updateStudentImage({title:l,collection:r,file:i,studentUsername:l,studentProject:u});case 6:case 9:return e.abrupt("return",e.sent);case 7:return e.next=9,a.Z.createImage(n,r,i);case 12:return e.prev=12,e.t0=e.catch(1),console.log("\uD83D\uDE80 ~ file: ProjectForm.tsx:136 ~ handleSubmit ~ error:",e.t0),e.abrupt("return",null);case 16:case"end":return e.stop()}},e,null,[[1,12]])}))).apply(this,arguments)}},4457:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e){return null!=e&&"object"==typeof e&&!1===Array.isArray(e)}},8270:function(e,t,n){n.d(t,{Z:function(){return r}});function r(e,t,n){return fetch(e).then(function(e){return e.arrayBuffer()}).then(function(e){return new File([e],t,{type:n})})}}}]);